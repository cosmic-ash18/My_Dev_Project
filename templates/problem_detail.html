{# templates/problem_detail.html #}
{% extends 'base.html' %}
{% block title %}{{ problem.title }}{% endblock %}

{% block content %}
<div class="row">
  {# ────────────────────────────────────────────────────────────── #}
  {# LEFT COLUMN: Problem Title + Description                         #}
  <div class="col-lg-6 mb-4">
    <div class="card shadow-sm h-100">
      <div class="card-header bg-primary text-white">
        <h2 class="mb-0">{{ problem.title }}</h2>
      </div>
      <div class="card-body">
        {# Use |linebreaks so that newlines in the description render as <p>…</p> blocks #}
        <div class="problem-description">
          {{ problem.description|linebreaks }}
        </div>
      </div>
    </div>
  </div>

  {# ────────────────────────────────────────────────────────────── #}
  {# RIGHT COLUMN: “Your Solution” Form                                  #}
  <div class="col-lg-6 mb-4">
    <div class="card shadow-sm h-100">
      <div class="card-header bg-secondary text-white">
        <h4 class="mb-0">Your Solution</h4>
      </div>
      <div class="card-body d-flex flex-column">
        <form method="post" action="{% url 'submit:submit_code' problem.id %}" class="flex-grow-1 d-flex flex-column">
          {% csrf_token %}
          <div class="row g-3 flex-grow-1">
            <div class="col-md-12">
              {{ form.language.label_tag }}
              {{ form.language }}
            </div>
            <div class="col-md-12 flex-grow-1">
              {{ form.code.label_tag }}
              {{ form.code }}
            </div>
            <div class="col-md-12">
              {{ form.stdin.label_tag }}
              {{ form.stdin }}
            </div>
          </div>

          <div class="mt-3 text-end">
            <button type="submit" name="action" value="run" class="btn btn-outline-primary">
              Run Code
            </button>
            <button type="submit" name="action" value="submit" class="btn btn-success ms-2">
              Submit
            </button>
            <button 
              formaction="{% url 'submit:suggest_improvements' problem.id %}"
              formmethod="post"
              class="btn btn-warning ms-2"
            >
              AI Assistant
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
